---
title: Running multiple agents | Dagster Docs
platform_type: "cloud"
---

# Running multiple agents <Experimental />

<Note>This guide is applicable to Dagster Cloud.</Note>

Each Dagster Cloud full deployment (e.g., `prod`) needs to have at least one agent running. A single agent is adequate for many use cases, but you may want to run multiple agents for the following reasons:

- Provide redundancy
- Distribute runs across multiple Kubernetes clusters, ECS clusters, EC2 instances, or other environments

It's recommended to only use multiple agents of the same type (e.g. multiple Kubernetes agents). Submitting runs to a specific agent isn't currently supported.

---

## Multiple agents in the same environments

If you want to run multiple agents in the same environment (e.g., multiple Kubernetes agents in the same namespace), you can set the number of replicas in the configuration for your particular agent type:

### In Docker

In docker, you can set the number of replicas for a service in the `docker-compose.yaml` file if the deployment mode is set to `replicated` (which is the default):

```yaml
services:
  dagster-cloud-agent:
    ...
    deploy:
      mode: replicated
      replicas: 2
```

### In Kubernetes

In Kubernetes, the number of replicas is set in the Helm chart. You can set the number of replicas in the Helm command:

```shell
helm upgrade \
    ...
    --set replicas=2
```

or if using a `values.yaml` file:

```yaml
dagsterCloudAgent:
  ...
  replicas: 2
```

### In ECS

In ECS, the number of replicas can be set via the cloudformation template:

```yaml
DagsterCloudAgent:
  Type: AWS::ECS::Service
  Properties:
    ...
    DesiredCount: 2
```

If using the cloudformation template provided by Dagster, the number of replicas can be set via the `NumReplicas` parameter in the AWS UI.

---

## Multiple agents in different environments

<Note>
  This feature requires dagster-cloud version 0.13.0 or later for both agents
  and job code. Sending requests to specific agents is not supported.{" "}
</Note>

If you want to run multiple agents in different environments (e.g., multiple Kubernetes agents in different namespaces), you need to enable the `isolated_agents` option. This is currently only supported for local, docker and kubernetes agents.

### In Docker

Add the following to the `dagster.yaml` file:

```yaml
isolated_agents:
  enabled: true

dagster_cloud_api:
  # <your other config>
  agent_label: "My agent" # optional
```

### In Kubernetes

Add the following options to your Helm command:

```shell
helm upgrade \
    ...
    --set agentReplicas.enabled=true \
    --set dagsterCloud.agentLabel="My agent" # optional, only supported on 0.13.14 and later
```

Or if you're using a `values.yaml` file:

```yaml
isolatedAgents:
  enabled: true

dagsterCloud:
  agentLabel: "My agent" # optional, only supported on 0.13.14 and later
```
